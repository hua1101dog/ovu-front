<!--维保单位新增修改弹出框  -->
<div class="modal-header">
    <button type="button" class="close" ng-click="vm.cancel()">×</button>
    <h4 class="modal-title">{{vm.topTitle}}维保单位</h4>
</div>
<div class="modal-body container-fluid form-horizontal">
    <div class="row">
        <div class="col-lg-12 col-sm-12">
            <form name="form" novalidate class="form-horizontal">
                <uib-tabset type="pills">
                    <uib-tab heading="基本信息维护" class="m-b">
                        <div class="panel panel-info">
                            <div class="panel-heading">单位基本信息-施工告知</div>
                            <div class="panel-body">
                                <div class="form-group">
                                    <label class="col-lg-2 col-sm-2 col-xs-2 control-label required">单位名称：</label>
                                    <div class="col-lg-2 col-sm-2  col-xs-2">
                                        <input type="text" class="form-control" ng-model="vm.item.companyName" required>
                                    </div>
                                    <label class="col-lg-2 col-sm-2 col-xs-2 control-label required">单位编码：</label>
                                    <div class="col-lg-2 col-sm-2  col-xs-2">
                                        <input type="text" class="form-control" name="number"
                                               ng-model-options="{debounce:1000}"
                                               ensure_unique="number"
                                               api='/ovu-pcos/pcos/maintenanceunit/mtu/checkNumberRepeat_mute'
                                               uib-popover="{{form.number.$error.unique?'编码已被使用':''}}"
                                               id="{{vm.item.id}}"
                                               popover-placement="top" popover-trigger="mouseenter"
                                               ng-model="vm.item.number" required>
                                    </div>
                                    <label class="col-lg-2 col-sm-2 col-xs-2 control-label required">组织机构代码：</label>
                                    <div class="col-lg-2 col-sm-2  col-xs-2">
                                        <input type="text" class="form-control" ng-model="vm.item.organizationCode"
                                               required>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-lg-2 col-sm-2 col-xs-2 control-label required">维保项目数：</label>
                                    <div class="col-lg-2 col-sm-2  col-xs-2">
                                        <input type="text" class="form-control" ng-model="vm.item.mtcProjectAmount"
                                               required>
                                    </div>
                                    <label class="col-lg-2 col-sm-2 col-xs-2 control-label required">维保电梯数：</label>
                                    <div class="col-lg-2 col-sm-2  col-xs-2">
                                        <input type="text" class="form-control" ng-model="vm.item.mtcElevatorAmount"
                                               required>
                                    </div>
                                    <label class="col-lg-2 col-sm-2 col-xs-2 control-label required">单位地址：</label>
                                    <div class="col-lg-2 col-sm-2  col-xs-2">
                                        <input type="text" class="form-control" ng-model="vm.item.unitAddress" required>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-lg-2 col-sm-2 col-xs-2 control-label required">管理员：</label>
                                    <div class="col-lg-2 col-sm-2  col-xs-2">
                                        <input type="text" class="form-control" ng-model="vm.item.admin" required>
                                    </div>
                                    <label class="col-lg-2 col-sm-2 col-xs-2 control-label required">座机：</label>
                                    <div class="col-lg-2 col-sm-2  col-xs-2">
                                        <input type="text" class="form-control" ng-model="vm.item.landline" required>
                                    </div>
                                    <label class="col-lg-2 col-sm-2 col-xs-2 control-label required">手机：</label>
                                    <div class="col-lg-2 col-sm-2  col-xs-2">
                                        <input type="text" class="form-control" ng-model="vm.item.phone" required>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-lg-2 col-sm-2 col-xs-2 control-label ">邮政编码：</label>
                                    <div class="col-lg-2 col-sm-2  col-xs-2">
                                        <input type="text" class="form-control" ng-model="vm.item.zipCode">
                                    </div>
                                    <label class="col-lg-2 col-sm-2 col-xs-2 control-label">传真：</label>
                                    <div class="col-lg-2 col-sm-2  col-xs-2">
                                        <input type="text" class="form-control" ng-model="vm.item.fax">
                                    </div>
                                    <label class="col-lg-2 col-sm-2 col-xs-2 control-label ">成立日期：</label>
                                    <div class="col-lg-2 col-sm-2  col-xs-2">
                                        <input type="text" class="form-control" ng-lay-date id="date1"
                                               ng-model="vm.item.dateOfEstablishment" >
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-lg-2 col-sm-2 col-xs-2 control-label ">营业执照登记机构：</label>
                                    <div class="col-lg-2 col-sm-2  col-xs-2">
                                        <input type="text" class="form-control"
                                               ng-model="vm.item.registrationInstitution">
                                    </div>
                                    <label class="col-lg-2 col-sm-2 col-xs-2 control-label ">营业执照注册号：</label>
                                    <div class="col-lg-2 col-sm-2  col-xs-2">
                                        <input type="text" class="form-control" ng-model="vm.item.licenseNumber">
                                    </div>
                                    <label class="col-lg-2 col-sm-2 col-xs-2 control-label required">管理人员总数：</label>
                                    <div class="col-lg-2 col-sm-2  col-xs-2">
                                        <input type="text" class="form-control" ng-model="vm.item.adminNum" required>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-lg-2 col-sm-2 col-xs-2 control-label required">技术人员总数：</label>
                                    <div class="col-lg-2 col-sm-2  col-xs-2">
                                        <input type="text" class="form-control" ng-model="vm.item.technicianNum"
                                               required>
                                    </div>
                                    <label class="col-lg-2 col-sm-2 col-xs-2 control-label ">质检人员总数：</label>
                                    <div class="col-lg-2 col-sm-2  col-xs-2">
                                        <input type="text" class="form-control" ng-model="vm.item.inspectorNum">
                                    </div>
                                    <label class="col-lg-2 col-sm-2 col-xs-2 control-label ">生产工人总数：</label>
                                    <div class="col-lg-2 col-sm-2  col-xs-2">
                                        <input type="text" class="form-control" ng-model="vm.item.productionWorkerNum">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-lg-2 col-sm-2 col-xs-2 control-label">注册资金(万元)：</label>
                                    <div class="col-lg-2 col-sm-2  col-xs-2">
                                        <input type="text" class="form-control" ng-model="vm.item.registeredCapital">
                                    </div>
                                    <label class="col-lg-2 col-sm-2 col-xs-2 control-label">固定资产(万元)：</label>
                                    <div class="col-lg-2 col-sm-2  col-xs-2">
                                        <input type="text" class="form-control" ng-model="vm.item.fixedAssets">
                                    </div>
                                    <label class="col-lg-2 col-sm-2 col-xs-2 control-label">法定代表人：</label>
                                    <div class="col-lg-2 col-sm-2  col-xs-2">
                                        <input type="text" class="form-control" ng-model="vm.item.legalRepresentative">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-lg-2 col-sm-2 col-xs-2 control-label required">邮箱：</label>
                                    <div class="col-lg-2 col-sm-2  col-xs-2">
                                        <input type="text" class="form-control" ng-model="vm.item.email" required>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="panel panel-info">
                            <div class="panel-heading">相关负责人</div>
                            <div class="panel-body">
                                <div class="row">
                                    <div class="col-lg-4 col-sm-4 col-xs-12" ng-repeat="title in vm.titles track by $index">
                                        <div class="panel panel-info">
                                            <div class="panel-heading">{{title}}</div>
                                            <div class="panel-body">
                                                <div class="row">
                                                    <div class="col-sm-8 col-xs-8">
                                                        <div class="form-horizontal"
                                                             ng-init="vm.item.personList[$index].type = $index+1">
                                                            <div class="form-group">
                                                                <label class="col-sm-4 control-label">姓名</label>
                                                                <div class="col-sm-8">
                                                                    <input type="text" class="form-control"
                                                                           ng-model="vm.item.personList[$index].name">
                                                                </div>
                                                            </div>
                                                            <div class="form-group">
                                                                <label class="col-sm-4 control-label">座机</label>
                                                                <div class="col-sm-8">
                                                                    <input type="text" class="form-control"
                                                                           ng-model="vm.item.personList[$index].landline">
                                                                </div>
                                                            </div>
                                                            <div class="form-group">
                                                                <label class="col-sm-4 control-label">手机</label>
                                                                <div class="col-sm-8">
                                                                    <input type="text" class="form-control"
                                                                           ng-model="vm.item.personList[$index].phone">
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-sm-4 col-xs-4">
                                                        <a class="thumbnail" style="height: 150px;">
                                                            <img onerror="javascript:this.src='/res/img/upload.jpg';"
                                                                 ng-click="$root.showPhoto()"
                                                                 ng-src="{{$root.processImgUrl(vm.item.personList[$index].photo)}}">
                                                            <div class="caption">
                                                                <p>
                                                                    <button class="btn btn-warning btn-sm" ng-click="$root.clearPhoto(vm.item.personList[$index],'photo')"><i
                                                                            class="glyphicon glyphicon-remove"></i></button>
                                                                    <button class="btn btn-default btn-sm" ng-click="$root.addPhoto(vm.item.personList[$index],'photo')"><i
                                                                            class="glyphicon glyphicon-picture "></i></button>
                                                                </p>
                                                            </div>

                                                            <!--<img onerror="javascript:this.src='/res/img/upload.jpg';"
                                                                 ng-click="vm.addPhoto(vm.item.personList[$index])"
                                                                 ng-src="{{'/ovu-pcos/'+vm.item.personList[$index].photo}}">-->
                                                        </a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </uib-tab>
                    <uib-tab heading="单位资质信息">
                        <div class="panel panel-info">
                            <div class="panel-heading">资质信息</div>
                            <div class="panel-body">
                                <div class="form-group">
                                    <label class="col-lg-2 col-sm-2 col-xs-2 control-label required">批准日期：</label>
                                    <div class="col-lg-4 col-sm-4  col-xs-4">
                                        <input type="text" class="form-control" ng-lay-date 
                                               ng-model="vm.item.approvalDate" required>
                                    </div>
                                    <label class="col-lg-2 col-sm-2 col-xs-2 control-label required">有效日期：</label>
                                    <div class="col-lg-4 col-sm-4  col-xs-4">
                                        <input type="text" class="form-control" ng-lay-date 
                                               ng-model="vm.item.validDate" required >
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-lg-2 col-sm-2 col-xs-2 control-label required">许可证编号：</label>
                                    <div class="col-lg-4 col-sm-4  col-xs-4">
                                        <input type="text" class="form-control" ng-model="vm.item.licenceNo" required>
                                    </div>
                                    <label class="col-lg-2 col-sm-2 col-xs-2 control-label ">设备类别：</label>
                                    <div class="col-lg-4 col-sm-4  col-xs-4">
                                        <input type="text" class="form-control" ng-model="vm.item.deviceClass">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-lg-2 col-sm-2 col-xs-2 control-label ">批准级别：</label>
                                    <div class="col-lg-4 col-sm-4  col-xs-4">
                                        <input type="text" class="form-control" ng-model="vm.item.approvalLevel">
                                    </div>
                                    <label class="col-lg-2 col-sm-2 col-xs-2 control-label ">资质证书批准范围：</label>
                                    <div class="col-lg-4 col-sm-4  col-xs-4">
                                        <input type="text" class="form-control" ng-model="vm.item.certificateRange">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="panel panel-info">
                            <div class="panel-heading"><label class="required">资质证书照片</label></div>
                            <div class="panel-body">
                                <a class="thumbnail" style="height: auto;">
                                  <!--  <img onerror="javascript:this.src='/res/img/upload.jpg';"
                                         ng-click="vm.addPhoto2(vm.item)"
                                         ng-src="{{'/ovu-pcos/'+vm.item.qualificationPhoto}}">-->

                                    <img onerror="javascript:this.src='/res/img/upload.jpg';"
                                         ng-click="$root.showPhoto()"
                                         ng-src="{{$root.processImgUrl(vm.item.qualificationPhoto)}}">
                                    <div class="caption">
                                        <p>
                                            <button class="btn btn-warning btn-sm" ng-click="$root.clearPhoto(vm.item,'qualificationPhoto')"><i
                                                    class="glyphicon glyphicon-remove"></i></button>
                                            <button class="btn btn-default btn-sm" ng-click="$root.addPhoto(vm.item,'qualificationPhoto')"><i
                                                    class="glyphicon glyphicon-picture "></i></button>
                                        </p>
                                    </div>
                                </a>
                            </div>
                        </div>
                    </uib-tab>
                </uib-tabset>
            </form>
        </div>
    </div>
</div>
<div class="modal-footer">
    <button class="btn btn-primary"  ng-click="vm.save(form,vm.item)">确定</button>
    <button class="btn btn-warning" ng-click="vm.cancel()">取消</button>
</div>
<style>
    .m-b {
        margin-bottom: 15px;
    }
</style>
